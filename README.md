# Splunk

<h1>Log Analysis with Splunk</h1>
<body>Completed this analysis with help of Try Hack Me.</body></br>
<body>Room info : Splunk Basics - Did you SIEM?</body></br>
Room Type:
Free Room.Anyone can deploy virtual machines in the room


<h2>Description</h2>
Project consists of
Ingest and interpret custom log data in Splunk
Create and apply custom field extractions
Use Search Processing Language (SPL) to filter and refine search results
Conduct an investigation within Splunk to uncover key insights like,

- Exploring the Logs
- Initial Triage
- Visualizing the Logs Timeline
- Anomaly Detection
- Filtering out Benign Values
- Narrowing Down Suspicious IPs
- Tracing the Attack Chain
- Exfiltration Attempts
- Ransomware Staging & RCE
- Correlate Outbound C2 Communication
- Volume of Data Exfiltrated

<h2>Languages and Utilities Used</h2>

- <b>Search Processing Language (SPL)</b> 
- <b>Virtual Machines deployed in Try Hack Me</b>

<h2>Environments Used </h2>

- <b>Windows 11</b> 

<h2>Program walk-through:</h2>

<p align="left">
<b>Exploring the Logs:</b> <br/>
The data has already been ingested into the Splunk instance for analysis. To begin investigating the incident, open the Splunk interface and click Search & Reporting from the left-hand panel, as shown below.
<br />
<br />
<img width="1364" height="792" alt="Image" src="https://github.com/user-attachments/assets/b8c7ea1e-222d-414a-86ad-0c968bf436a1" />
<br />
<br />
On the next page, enter index=main in the search bar to display all the ingested logs.
<br />
<br />
<img width="1919" height="1199" alt="2" src="https://github.com/user-attachments/assets/1926c562-29bf-455c-a549-f0edda7ab08d" />
The investigation involves two primary datasets:<br />
  
- <b>web_traffic:</b> Contains events related to incoming and outgoing web connections associated with the web server.<br />
  
- <b>firewall_logs:</b> Includes firewall records that indicate whether network traffic was allowed or blocked.<br />
The web server is assigned the local IP address 10.10.1.15.
---------------------------------------------------------------------------------------------------------------------------------
<br />
<b>Initial Triage:</b> <br />
Begin by running a basic search on the index using the custom source type web_traffic. In the search bar, enter the following query:

<b>Search Query:</b> index=main sourcetype=web_traffic
<br />
<br />
<img width="1919" height="1199" alt="3" src="https://github.com/user-attachments/assets/0d22a7ae-c84a-48a7-954f-79b4ac2237f7" />
<br />
<br />
Let’s break down the results to better understand what we’re seeing in Splunk:

<b>Search query:</b> This query pulls all events from the main index that are tagged with the custom source type web_traffic. It serves as the starting point for our investigation and ensures we’re working with the correct dataset.

<b>Time range:</b> The search is currently set to All time, allowing us to view the complete dataset. During an actual security investigation, this range would typically be narrowed down later such as focusing on the specific time window where abnormal activity or traffic spikes were observed.

<b>Timeline:</b> The histogram visualizes how the 17,172 events are distributed over time. It shows normal daily log activity followed by a noticeable spike in traffic, which likely corresponds to the potential attack window.

<b>Selected fields:</b> These are the fields currently displayed in the event list summary (such as host, source, and sourcetype). They provide basic metadata about where the logs originated and how they were ingested.

<b>Interesting fields:</b> This panel displays all fields that Splunk has either automatically extracted or manually defined. Fields prefixed with # (for example, #date_hour) are automatically generated by Splunk’s time-based commands. The presence of fields like user_agent, path, and client_ip confirms that the web logs have been parsed correctly.

<b>Event details & field extraction:</b> This section shows the detailed breakdown of an individual event, including extracted fields such as user_agent, path, status, client_ip, and others. These fields will be critical for identifying suspicious behavior during the investigation.

Now that we have a solid understanding of the Splunk interface and how to interpret the logs, we can move forward with a deeper analysis of the dataset.

---------------------------------------------------------------------------------------------------------------------------------
<br />
<b>Visualizing the Logs Timeline:</b> <br />




<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
